package com.oracle;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.Arrays;
import java.util.HashMap;
import java.util.HashSet;
import java.util.Map;
import java.util.Set;
import java.util.stream.Collectors;

/**
 * Created by sshil on 7/26/2016.
 */
public class FacilityMapping {
    public static final String DSVS = "522123,267750,270058,24302,349295,450361,41243,242206,404041,472184,538801,172580,482995,455709,\n" +
        "533075,291500,519322,57474,414875,215411,261092,414560,175257,274893,530188,53590,51903,450734,\n" +
        "466863,232073,264153,9167,456673,9399,464581,9696,166222,23804,268194,224071,511873,524256,210123,\n" +
        "261593,261284,30085,451253,490535,451930,19251,232341,224264,232162,228163,537210,516743,420324,\n" +
        "469270,336586,40238,397612,97684,520192,453830,268244,60202,441030,537816,220699,48785,57932,54101,\n" +
        "33931,409483,19299,360297,72041,144204,152009,424815,92681,446310,319657,151134,267911,415174,462866,\n" +
        "14674,119826,17621,13992,510818,283747,185371,481358,438112,353004,105999,14285,338301,422662,428235,\n" +
        "117635,297072,362541,448878,388642,444096,205567,152230,73445,270794,349772,468731,474346,182568,\n" +
        "429241,211698,225474,5632,333432,415870,13801,251405,299142,437023,208751,151779,295758,415455,\n" +
        "468350,100680,390792,533223,122663,40055,395841,487624,424556,131540,297064,320700,14818,465831,\n" +
        "476812,199844,256233,455501,514203,489922,79512,463862,212001,527254,411546,485283,525733,348370,\n" +
        "536516,386763,261198,330639,477183,232903,457317,19433,205453,466972,357988,212592,95052,457002,\n" +
        "272831,408392,258657,363130,228643,447490,446620,437742,9681,466964,487552,211636,515143,270053,\n" +
        "8870,520056,364961,182006,453111,272112,151761,54733,477122,45404,236240,109465,297416,542792,543426,\n" +
        "543942,546450,547003,547045,549203,549568,555584,556506,557653,558502,566638,588723,604132,608893,\n" +
        "614542,616683,617410,619992,631531,631838,643205,656034,657582,658271,665102,670882,673736,674135,\n" +
        "674155,678495,688973,707882,727763,728583,729981,731356,731565,731893,731932,732958,735055,735105,\n" +
        "735290,736434,736465,736835,738013,739055,739485,739733,740217,755931,755952,756083,813113,856034,\n" +
        "867200,883982,902189,916702,916703,916704,956987,967174,968818,4167301,4167302,4167303,10946501,10946502,\n" +
        "10946503,17870001,17870002,17870003,17870004,17870005,17870006,17870007,17870008,17870009,17870010,17870011,\n" +
        "23207302,25170201,25865703,26512301,26512302,26512303,26512304,26512305,26512306,26512307,26512308,26512309,\n" +
        "26512310,26512311,26512312,26512313,27079402,27079403,35798802,37360501,37360502,45581601,45581602,\n" +
        "50453501,50453502,50453503,50453504,50453505,50453506,50453507,61710502,66510202,66510204,66510205,66510206,\n" +
        "66510207,73643401,73643402,73643403,73643404,75560401,227794061,232145470,730450690,888880009,\n" +
        "236943,218727,49380,441290,414078,140660,234336,200973,512912,34764,420117,53244,535872,483781,455140,\n" +
        "144675,441823,52780,243454,336474,291377,472766,255653,5580,473215,430785,61859,492283,254552,498456,\n" +
        "463252,478313,483693,422266,121681,46030,521666,446883,385005,447103,448035,436253,195461,49973,490933,8979,434501,\n" +
        "221401,505656,144013,477904,20266,295413,480395,503771,52962,226972,737,385401,502824,420912,\n" +
        "8789,299403,484279,4245,57174,170605,138151,470187,455892,533422,484173,263434,452842,33780,\n" +
        "446562,514942,263376,453994,413992,503946,473785,439794,260976,474935,494873,358734,38490,337204,\n" +
        "479462,439781,462142,477551,466812,512973,39511,522572,479342,529502,338054,414782,480932,451187,\n" +
        "23114,224543,505704,85612,262444,53660,13441,472343,238428,233331,486333,422342,257773,467626,483941,\n" +
        "488291,15728,504394,258848,419643,9321,422365,260414,454900,454371,486602,259890,516632,487794,525983,\n" +
        "480616,516230,357343,485584,450106,258132,480623,475080,514273,467491,486043,416122,251736,204537,\n" +
        "448152,392412,428141,535115,501402,22921,524523,451851,420323,49262,512087,286745,471915,274514,321653,\n" +
        "271242,502271,471156,520148,306845,472891,450822,487465,252642,432914,534909,482497,466764,461926,261235,\n" +
        "263551,192500,519579,275744,420223,514474,484113,36996,52814,492256,451982,171921,213592,395954,481408,\n" +
        "372540,366042,444284,255521,496695,53653,479811,257403,258640,449363,477489,517482,12254,73668,392951,\n" +
        "448145,257571,89656,274493,166793,73702,460835,525758,199336,98046,516113,39433,347040,209908,24542,\n" +
        "243421,480280,265186,514673,473157,434969,56484,185124,470812,445143,176112,356,89433,502533,513317,\n" +
        "258541,404061,39452,230602,40292,308577,17871,167957,266620,525993,445171,485631,502863,192154,411632,\n" +
        "482755,305321,374702,255831,269402,514463,465005,187559,519871,511710,212451,51755,434865,448811,278101,\n" +
        "45014,470484,481572,230533,446602,480953,271072,411781,136874,512103,140913,285155,486436,487405,480983,\n" +
        "20146,237086,22381,488734,189308,433664,325196,542103,542752,542921,543453,543903,544834,544893,545566,545924,\n" +
        "546181,546382,552794,552828,553755,554165,554456,554514,555826,556103,556410,570200,580670,581273,609222,\n" +
        "613182,616584,616622,616735,616883,617399,624162,624263,638775,639483,655012,655541,658115,660754,665813,\n" +
        "673884,673926,675678,722101,729186,729593,729660,731211,731534,731596,732492,732495,732821,735738,736333,\n" +
        "738633,738666,739714,743351,751867,754583,754801,755424,755483,755552,755642,783159,792226,821389,840777,\n" +
        "843839,870881,895144,911867,933635,970657,990259,992719,1928101,1928102,1928103,3676401,3676402,3676403,3676404,\n" +
        "5175502,6185902,6185903,9228301,10930602,12168102,13687402,20371101,20371102,22748802,23125802,26057301,26097602,\n" +
        "26505301,27306301,27306302,27306309,27416702,28793301,30089701,30429501,34179301,40404102,40404103,40575301,\n" +
        "41354501,41354502,43162001,43162002,43162003,43162004,43162005,43162006,43430801,43842302,43842303,44369701,\n" +
        "44512201,44512202,44781302,45199701,45258101,45389301,45389302,45438201,46078501,46078502,46252401,46629502,\n" +
        "47048402,47048403,47290301,47397502,47929201,47929202,48039502,48417302,48417303,49093302,49487302,51501501,\n" +
        "51564301,52317501,53550001,53550002,54519401,54782801,65974102,66362202,67543901,67543902,73153402,73153403,\n" +
        "73801302,73966101,74339401,74339402,75542402,75618202,82138902,84383902,96717402,888880004,888880006,888880007,\n" +
        "888880008,888880014,888880015,888880016,888880017,888880019,888880020,888880021,888880023,888880024,888880026,\n" +
        "888880031,888880032,888880033,888880034,888880035,888880036,888880038,888880039,888880040,888880041,888880044,\n" +
        "888880047,888880050,888880057,888880059,888880060,888880061,888880065,888880067,888880073,888880075,888880076,\n" +
        "888880077,888880078,888880081,888880082,888880086,888880087,888880093,888880094,888880097,888880098,888880100,888880101";

    public static final String DSV1 = "356,737,3924,4245,5580,5632,6893,7750,8078,8573,8789,8870,8979,9167,9321,9399,9681,9696,10051,10052,12254,13441,13801,13992,14285,14674,14818,15728,17621,17871,19299,19433,21156,22381,22921,23114,23804,24542,24930,25189,30085,33081,33780,33931,34306,34764,36996,38490,39433,39452,39511,40055,40063,40238,40292,41243,45014,45404,46030,48785,49262,49380,49973,51755,51903,52780,52814,52962,53244,53590,53653,53660,54101,54733,56484,57174,57474,57932,60202,61859,72041,73270,73445,73668,73702,79512,80583,85612,89433,89656,92681,95052,95930,97684,98046,100001,100002,100003,100004,100680,105999,109843,115329,116421,117635,119826,121681,127001,131540,136874,138151,139924,139985,140660,140913,144013,144204,144675,150102,151134,151761,151779,152009,160846,166222,166793,167957,170605,171921,172580,175257,176112,182006,182568,185124,185371,187559,189308,192154,192500,194994,195461,196280,199336,199844,200973,204537,205453,205567,208083,208751,209908,210123,211636,211698,212001,212451,212592,213592,215411,218727,220699,221401,222250,222885,224071,224264,224543,225474,227488,228163,228643,230533,230602,230847,231860,232073,232162,232341,232523,232903,233331,234336,234935,236240,236943,237086,238428,239095,242206,243421,245511,251405,251603,251736,252642,253242,254552,255521,255653,255831,256233,257403,257571,257773,257801,258129,258132,258418,258541,258640,258657,258801,258848,259890,260414,260976,261092,261198,261235,261284,261593,262043,262444,263376,263434,263551,264153,265186,266620,267336,267562,267750,267911,268194,268244,269402,270053,270058,270741,270794,271072,271242,272112,272831,274493,274514,274830,275744,278101,281501,283747,285155,286745,290141,291377,291500,295413,295758,297064,297072,297416,299142,299403,305321,306845,308577,312025,312124,319657,320700,321034,321653,325196,330639,331046,333432,336474,336586,337204,338054,338301,340588,340760,347040,348370,349295,349772,353004,357343,357988,358310,358734,360297,361074,362541,363130,364961,366042,369093,372540,374702,385005,385401,386763,388642,388652,390792,392412,392951,395841,395954,397612,399084,404041,404061,408392,409483,409980,411546,411561,411632,411781,412493,413125,413992,414078,414136,414295,414560,414782,414875,415174,415455,415870,416122,419643,420117,420223,420323,420324,420912,422266,422342,422365,422662,424556,424815,425223,428141,428235,428305,429241,430785,431812,432483,432914,433664,434501,434865,434969,467491,533869,538201,538202,577201,577202,577203,577204,577205,731534,735105,887581,916702,916703,916704,1751201,1751202,1751203,1751204,1751205,1762102,1928101,1928102,1928103,2233501,2233502,2233503,2380402,2380403,2380404,2380405,2380406,2380407,2380408,2380409,2957901,2957902,2957903,2957904,2957905,2957906,2957909,2957910,2957911,2957912,2957913,2957914,2957915,2957916,2957917,3517501,3517502,3676401,3676402,3676403,3676404,4020301,4020302,4167301,4167302,4167303,5175502,5175503,5175504,5359002,5359003,6020201,6020202,6020203,6020204,6020205,6185902,6185903,7204102,9228301,9710501,10100601,10100602,10100603,10946501,10946502,10946503,11168201,11168202,11168203,12168102,12266301,12266302,12266303,13687402,13687403,17192102,17870001,17870002,17870003,17870004,17870005,17870006,17870007,17870008,17870009,17870010,17870011,19018101,19215402,19628003,19628004,19664201,19664202,20371101,20371102,20875102,21163602,22267401,22267402,22748802,22748803,22748804,22748805,22864302,23125802,23207302,23335201,23493502,23844401,23844402,23844403,23844404,23844405,23844406,23844407,24342102,24342103,24342104,25170201,25602401,25864003,25865702,25865703,26057301,26097602,26097603,26102401,26102402,26102403,26102405,26102406,26505301,26512301,26512302,26512303,26512304,26512305,26512306,26512307,26512308,26512309,26512310,26512311,26512312,26512313,26512314,26768301,26768302,26768303,26812301,26812302,26812303,27079402,27079403,27079404,27306301,27306302,27306309,27416702,28698201,28698202,28793301,29137702,29706401,29706402,29706403,29706404,29706405,29706406,29706407,30089701,30429501,31212403,33042401,33042402,33042403,33042406,33042407,33042408,33042409,33042410,33042411,33042412,33104602,33541301,33541302,34179301,35798802,35798803,36604202,37360501,37360502,38500502,38865202,39079201,39079202,39079203,39079204,39515201,39515202,39515203,39515204,39595402,40404102,40404103,40557102,40557103,40575301,40839202,41247102,41247103,41354501,41354502,41456002,41456003,41456005,41456006,41456007,41819301,41819302,42055401,42055402,42455602,43162001,43162002,43162003,43162004,43162005,43162006,43162007,43430802,73153402,73153403,232145470,888880008,888880009,888880018,888880033,888880056,888880092,19251,20146,20266,24302,226972,243454,274893,409313,436253,437023,437742,438112,438423,439704,439781,439794,441290,441823,444096,444284,445143,445171,445288,445572,446042,446310,446562,446602,446612,446620,446883,447103,447490,447813,448035,448145,448152,448811,448878,449363,450012,450106,450361,450734,450822,451187,451253,451851,451930,451982,452842,453111,453134,453352,453830,453994,454058,454192,454371,454900,455114,455140,455501,455709,455892,456551,456673,457002,457317,458654,460835,461611,461926,462142,462866,463005,463252,463862,463935,464581,465005,465831,466764,466812,466863,466964,466972,466992,467415,467626,468350,468731,468832,469270,470187,470321,470484,470812,471156,471915,472184,472343,472590,472766,472891,473157,473215,473785,473853,474346,474935,475080,475431,475445,476812,477122,477183,477489,477551,477904,478313,479342,479462,479520,479811,480280,480395,480616,480623,480665,480932,480953,480983,481358,481408,481572,482497,482755,482995,483643,483669,483693,483781,483941,484113,484173,484279,485283,485584,485631,486043,486333,486436,486552,486602,487405,487465,487552,487574,487624,487794,488291,488734,489922,490535,490933,492256,492275,492283,494723,494873,496695,498456,501402,502271,502533,502824,502863,502955,503771,503946,504394,505656,505704,509993,510818,511710,512087,512103,512912,512973,513317,514203,514273,514463,514474,514482,514513,514673,514942,515143,516113,516230,516632,516743,517482,517972,519322,519566,519579,519871,520056,520063,520148,520192,521666,522123,522156,522572,524256,524523,524642,525043,525733,525758,525983,525993,527254,529502,530188,530618,532114,532515,533075,533223,533422,533692,534492,534891,534909,535115,535237,535872,535984,536516,536912,537210,537816,538384,538751,538782,538801,538804,538842,542103,542752,542792,542921,543426,543453,543903,544726,544834,544893,545327,545566,545650,545924,546181,546234,546382,546450,546531,547003,731211,43496902,43774201,43774202,43774203,43774204,43842302,43842303,44103001,44103004,44103005,44103006,44369701,44369702,44512201,44512202,44512203,44604202,44781302,44810501,44810502,44810503,44810504,45199701,45258101,45258102,45389301,45389302,45438201,45438202,45581601,45581602,45667302,45751001,45751003,45751004,46078501,46078502,46252401,46252402,46318501,46318502,46583102,46583103,46629502,46725802,46927002,47048402,47048403,47218402,47290301,47290302,47385302,47397502,47773001,47773002,47929201,47929202,48039502,48050901,48050902,48050903,48130403,48130404,48218302,48417302,48417303,48604302,49053502,49093302,49236301,49236302,49487302,50453501,50453502,50453503,50453504,50453505,50453506,50453507,51081802,51446302,51501501,51501502,51564301,51564302,52317501,52464202,53000601,53000602,53000603,53000604,53000605,53337501,53337502,53550001,53550002,53691202,53728301,53728302,54519401,54519402,54653102,54653103,54653104,547003001,547003002,547003003,547003004,547003005,547003006,547003007,547003008,547003009,547003010,547003011,547003012,547003013,547003014,547003015,547003016,547003017,547003018,547003019,547003020,547003021,547003022,547003023,547003024,547003025,547003026,547003027,547003028,547003029,547003030,547003031,547003032,547003033,547003034,547003035,547003036,547003037,547003038,547003039,547003040,547003041,547003042,547003043,547003044,547003045,547003046,547003047,547003048,547003049,547003050,547003051,547003052,547003053,547003054,547003055,547003061,547003062,547003063,547003064,547003065,547003066,547003067,547003068,547003069,547003070,547003071,547003072,547003073,547003074,547003075,547003076,547003077,547003078,547003079,547003080,547003081,547003082,547003083,547003084,888880000,888880001,888880004,888880006,888880007,888880011,888880012,888880013,888880014,888880015,888880016,888880017,888880019,888880020,888880021,888880022,888880023,888880026,888880031,888880032,888880034,888880035,888880036,888880038,888880039,888880040,888880044,888880045,888880047,888880050,888880051,888880053,888880054,888880057,888880059,888880060,888880061,888880065,888880067,888880068,888880073,888880075,888880076,888880077,888880078,888880079,888880080,888880081,888880082,888880083,888880084,888880086,888880087,888880093,888880094,888880097,888880098,888880100,888880101,108845,152230,543942,547045,549203,549264,549568,552794,552828,553755,554165,554456,554514,555334,555584,555826,556103,556410,556506,556552,556863,556886,556936,557285,557653,558364,558502,564187,566638,570200,577148,577693,578851,580670,581273,581546,588723,591573,594853,604132,604412,607953,608893,609222,610494,612633,613182,614542,615088,616584,616622,616683,616735,616847,616883,617022,617105,617399,617410,618181,619992,620695,620962,621141,621533,621832,624263,624364,625090,631531,631838,633324,634231,634264,638775,639483,643205,655012,655541,656034,657582,657901,658115,658271,659992,660754,663622,665102,665813,670882,672912,673445,673736,673884,673926,674135,674155,675678,678495,688122,688262,688973,697300,697359,707882,717913,722101,727763,728583,729186,729593,729660,729981,730104,731356,731565,731596,731893,731932,732492,732495,732730,732821,732958,734611,734973,735055,735290,735738,736333,736434,736465,736835,10930601,10930602,54782801,54886001,54886002,54886003,54886004,54886005,55558402,55693602,55693603,55693604,55693605,55693606,55693607,55693608,55693609,55693610,55836402,60441202,60441203,60441204,60889302,61049402,61710502,65616201,65616202,65616203,65616205,65839401,65839402,65974101,65974102,66170502,66170503,66170504,66170505,66170506,66170507,66218201,66218202,66218203,66218204,66362202,66510202,66510203,66510204,66510205,66510206,66510207,66510208,66510209,67088202,67420301,67420302,67543901,67543902,69728102,69728103,71791302,71791303,71791304,71791305,71791306,71791307,72776302,73045002,73204301,73204302,73204303,73204304,73204305,73505502,73505503,73505504,73643401,73643402,73643403,73643404,73643405,73643406,547003085,547003086,547003087,547003088,547003089,547003090,547003091,547003092,547003093,547003094,547003095,547003096,547003097,547003098,547003099,547003100,547003101,547003102,547003103,547003104,547003105,547003106,547003107,547003108,547003109,547003110,547003111,547003112,547003113,547003114,547003115,547003116,547003117,547003118,547003119,547003120,547003121,730450690,735055001,735055002,888880024,888880025,888880041,738013,738190,738633,738666,739055,739485,739714,739733,739875,740217,743351,749544,751867,754583,754801,755272,755424,755483,755552,755642,755931,755952,755975,756083,756182,783159,788512,792226,792252,803551,813113,816251,821389,834153,840777,843839,853168,856034,867200,870881,883982,895144,902189,905331,911867,924713,933635,941476,954993,956987,967174,968818,970657,990259,992719,22797062,43430801,43430803,43430804,43430805,73801302,73966101,73973001,73973002,74013101,74013102,74021702,74339401,74339402,75051302,75051303,75542402,75560401,75560402,75560403,75618202,75618203,78851202,82138902,83415301,83415302,83415303,83415304,83415305,84383902,94147602,94147603,96717402,98026801,98026802,227794061,888880043,888880048,888880058,888880066,888880070,888880085,888880091,888880095,888880096,901145,547003056,547003057,547003058,547003059,547003060,29137703,48299502,54279202,54279203,54279204,55650602,560691,56069102,56069103,56069104,56069105,56069106,56069107,56069108,56069109,56069110,56069111,56069112,56069113,56069114,56069115,56069116,56069117,56069118,56069119";
    private static final String SQL = "select * from wfu_message_type_trans where message_type in (select message_type from wfu_message_types where distributor_id in (522123,267750,270058,24302,349295,450361,41243,242206,404041,472184,538801,172580,482995,455709,\n" +
        "533075,291500,519322,57474,414875,215411,261092,414560,175257,274893,530188,53590,51903,450734,\n" +
        "466863,232073,264153,9167,456673,9399,464581,9696,166222,23804,268194,224071,511873,524256,210123,\n" +
        "261593,261284,30085,451253,490535,451930,19251,232341,224264,232162,228163,537210,516743,420324,\n" +
        "469270,336586,40238,397612,97684,520192,453830,268244,60202,441030,537816,220699,48785,57932,54101,\n" +
        "33931,409483,19299,360297,72041,144204,152009,424815,92681,446310,319657,151134,267911,415174,462866,\n" +
        "14674,119826,17621,13992,510818,283747,185371,481358,438112,353004,105999,14285,338301,422662,428235,\n" +
        "117635,297072,362541,448878,388642,444096,205567,152230,73445,270794,349772,468731,474346,182568,\n" +
        "429241,211698,225474,5632,333432,415870,13801,251405,299142,437023,208751,151779,295758,415455,\n" +
        "468350,100680,390792,533223,122663,40055,395841,487624,424556,131540,297064,320700,14818,465831,\n" +
        "476812,199844,256233,455501,514203,489922,79512,463862,212001,527254,411546,485283,525733,348370,\n" +
        "536516,386763,261198,330639,477183,232903,457317,19433,205453,466972,357988,212592,95052,457002,\n" +
        "272831,408392,258657,363130,228643,447490,446620,437742,9681,466964,487552,211636,515143,270053,\n" +
        "8870,520056,364961,182006,453111,272112,151761,54733,477122,45404,236240,109465,297416,542792,543426,\n" +
        "543942,546450,547003,547045,549203,549568,555584,556506,557653,558502,566638,588723,604132,608893,\n" +
        "614542,616683,617410,619992,631531,631838,643205,656034,657582,658271,665102,670882,673736,674135,\n" +
        "674155,678495,688973,707882,727763,728583,729981,731356,731565,731893,731932,732958,735055,735105,\n" +
        "735290,736434,736465,736835,738013,739055,739485,739733,740217,755931,755952,756083,813113,856034,\n" +
        "867200,883982,902189,916702,916703,916704,956987,967174,968818,4167301,4167302,4167303,10946501,10946502,\n" +
        "10946503,17870001,17870002,17870003,17870004,17870005,17870006,17870007,17870008,17870009,17870010,17870011,\n" +
        "23207302,25170201,25865703,26512301,26512302,26512303,26512304,26512305,26512306,26512307,26512308,26512309,\n" +
        "26512310,26512311,26512312,26512313,27079402,27079403,35798802,37360501,37360502,45581601,45581602,\n" +
        "50453501,50453502,50453503,50453504,50453505,50453506,50453507,61710502,66510202,66510204,66510205,66510206,\n" +
        "66510207,73643401,73643402,73643403,73643404,75560401,227794061,232145470,730450690,888880009, \n" +
        "236943,218727,49380,441290,414078,140660,234336,200973,512912,34764,420117,53244,535872,483781,455140,\n" +
        "144675,441823,52780,243454,336474,291377,472766,255653,5580,473215,430785,61859,492283,254552,498456,\n" +
        "463252,478313,483693,422266,121681,46030,521666,446883,385005,447103,448035,436253,195461,49973,490933,8979,434501,\n" +
        "221401,505656,144013,477904,20266,295413,480395,503771,52962,226972,737,385401,502824,420912,\n" +
        "8789,299403,484279,4245,57174,170605,138151,470187,455892,533422,484173,263434,452842,33780,\n" +
        "446562,514942,263376,453994,413992,503946,473785,439794,260976,474935,494873,358734,38490,337204,\n" +
        "479462,439781,462142,477551,466812,512973,39511,522572,479342,529502,338054,414782,480932,451187,\n" +
        "23114,224543,505704,85612,262444,53660,13441,472343,238428,233331,486333,422342,257773,467626,483941,\n" +
        "488291,15728,504394,258848,419643,9321,422365,260414,454900,454371,486602,259890,516632,487794,525983,\n" +
        "480616,516230,357343,485584,450106,258132,480623,475080,514273,467491,486043,416122,251736,204537,\n" +
        "448152,392412,428141,535115,501402,22921,524523,451851,420323,49262,512087,286745,471915,274514,321653,\n" +
        "271242,502271,471156,520148,306845,472891,450822,487465,252642,432914,534909,482497,466764,461926,261235,\n" +
        "263551,192500,519579,275744,420223,514474,484113,36996,52814,492256,451982,171921,213592,395954,481408,\n" +
        "372540,366042,444284,255521,496695,53653,479811,257403,258640,449363,477489,517482,12254,73668,392951,\n" +
        "448145,257571,89656,274493,166793,73702,460835,525758,199336,98046,516113,39433,347040,209908,24542,\n" +
        "243421,480280,265186,514673,473157,434969,56484,185124,470812,445143,176112,356,89433,502533,513317,\n" +
        "258541,404061,39452,230602,40292,308577,17871,167957,266620,525993,445171,485631,502863,192154,411632,\n" +
        "482755,305321,374702,255831,269402,514463,465005,187559,519871,511710,212451,51755,434865,448811,278101,\n" +
        "45014,470484,481572,230533,446602,480953,271072,411781,136874,512103,140913,285155,486436,487405,480983,\n" +
        "20146,237086,22381,488734,189308,433664,325196,542103,542752,542921,543453,543903,544834,544893,545566,545924,\n" +
        "546181,546382,552794,552828,553755,554165,554456,554514,555826,556103,556410,570200,580670,581273,609222,\n" +
        "613182,616584,616622,616735,616883,617399,624162,624263,638775,639483,655012,655541,658115,660754,665813,\n" +
        "673884,673926,675678,722101,729186,729593,729660,731211,731534,731596,732492,732495,732821,735738,736333,\n" +
        "738633,738666,739714,743351,751867,754583,754801,755424,755483,755552,755642,783159,792226,821389,840777,\n" +
        "843839,870881,895144,911867,933635,970657,990259,992719,1928101,1928102,1928103,3676401,3676402,3676403,3676404,\n" +
        "5175502,6185902,6185903,9228301,10930602,12168102,13687402,20371101,20371102,22748802,23125802,26057301,26097602\n" +
        ",26505301,27306301,27306302,27306309,27416702,28793301,30089701,30429501,34179301,40404102,40404103,40575301,\n" +
        "41354501,41354502,43162001,43162002,43162003,43162004,43162005,43162006,43430801,43842302,43842303,44369701,\n" +
        "44512201,44512202,44781302,45199701,45258101,45389301,45389302,45438201,46078501,46078502,46252401,46629502,\n" +
        "47048402,47048403,47290301,47397502,47929201,47929202,48039502,48417302,48417303,49093302,49487302,51501501,\n" +
        "51564301,52317501,53550001,53550002,54519401,54782801,65974102,66362202,67543901,67543902,73153402,73153403,\n" +
        "73801302,73966101,74339401,74339402,75542402,75618202,82138902,84383902,96717402,888880004,888880006,888880007,\n" +
        "888880008,888880014,888880015,888880016,888880017,888880019,888880020,888880021,888880023,888880024,888880026,\n" +
        "888880031,888880032,888880033,888880034,888880035,888880036,888880038,888880039,888880040,888880041,888880044,\n" +
        "888880047,888880050,888880057,888880059,888880060,888880061,888880065,888880067,888880073,888880075,888880076,\n" +
        "888880077,888880078,888880081,888880082,888880086,888880087,888880093,888880094,888880097,888880098,888880100,888880101) and IS_INBOUND='N');\n";

    public static final String NEW_DSVS= "40063,54653104,432483,730104,47385302,74021702,388652,33541301,734973,33541302,538842,445572,12266303,12266302,547003101,547003100,12266301,547003105,411561,607953,547003104,546234,547003103,547003102,547003109,547003108,547003107,547003106,534492,66170504,66170503,66170502,31212403,47773001,47773002,547003112,547003111,547003110,547003116,66170507,547003115,66170506,547003114,230847,66170505,547003113,547003119,547003118,455114,547003117,479520,160846,5359002,5359003,547003121,547003120,44103006,11168203,11168202,44103004,11168201,44103005,23844402,23844401,53000605,53000604,53000603,48218302,53000602,604412,53000601,48299502,29137702,29137703,80583,446612,43496902,517972,44103001,46583103,46583102,227488,616847,54653102,65839401,54653103,65839402,453134,732730,25602401,2957910,2957911,2957912,577148,2957913,2957914,2957915,2957916,2957917,834153,21156,26812302,26812303,54279202,468832,48130403,48130404,788512,453352,487574,23844407,35798803,26812301,23844404,23844403,23844406,23844405,39079203,39079202,534891,39079204,2233501,535984,2233502,2233503,555334,617105,39079201,2957901,2957902,2957903,2957904,2957905,2957906,2957909,621832,55558402,258801,663622,24342104,520063,24342102,24342103,450012,39595402,673445,72776302,620962,60441203,60441204,60441202,312124,66218203,66218204,524642,66218201,66218202,43162007,262043,545327,41819302,41819301,538804,756182,239095,532515,414136,618181,17192102,428305,222885,577202,33081,577201,612633,267562,46318502,46318501,544726,245511,519566,577693,67420301,41247103,41247102,67420302,577204,577203,47218402,577205,659992,44604202,26097603,509993,556936,108845,8573,425223,816251,73204304,73204303,73204305,634231,73204302,73204301,536912,620695,61049402,258418,40839202,621533,45667302,755272,533869,492275,54279203,54279204,94147603,55836402,94147602,617022,267336,615088,634264,270741,51501502,463935,56069115,56069114,56069113,56069112,56069119,75560403,56069118,20875102,75560402,56069117,56069116,33104602,56069109,56069104,56069103,56069102,56069108,514482,56069107,56069106,56069105,3924,222250,56069111,56069110,538201,538202,369093,445288,19664201,22267402,43430802,22267401,43430803,43430804,43430805,19664202,290141,43774201,43774202,73643405,73643406,44369702,621141,74013102,792252,74013101,672912,688262,43774203,610494,43774204,54886001,54886002,54886003,54886004,54886005,26512314,49053502,901145,633324,739875,454192,75618203,54519402,251603,139924,535237,361074,55650602,24930,42455602,538751,40557103,40557102,480665,734611,560691,45751004,45751003,409313,194994,46927002,340588,456551,22748805,22748804,22748803,25865702,738190,522156,697300,45258102,95930,657901,467415,538782,853168,547003002,547003001,547003006,547003005,547003004,547003003,547003009,547003008,547003007,697359,547003013,547003012,547003011,547003010,547003017,73973002,547003016,73973001,547003015,547003014,547003019,755975,547003018,624364,51081802,557285,78851202,547003020,547003024,547003023,547003022,547003021,547003028,547003027,231860,547003026,547003025,547003029,558364,547003031,447813,547003030,3517501,547003035,3517502,547003034,547003033,547003032,100001,23335201,547003039,100002,547003038,100003,51446302,547003037,100004,547003036,533692,591573,547003042,547003041,547003040,905331,547003046,547003045,547003044,532114,547003043,340760,44810503,44810502,547003049,546531,547003048,44810504,547003047,547003053,73270,547003052,257801,547003051,547003050,547003057,547003056,547003055,547003054,547003059,547003058,52464202,954993,803551,26102401,26102402,46725802,6893,29706401,556552,26102403,547003060,26102405,26102406,466992,547003064,234935,547003063,625090,547003062,547003061,547003068,581546,547003067,547003066,65974101,547003065,547003069,7750,44810501,98026801,98026802,463005,594853,6020201,6020202,547003071,6020203,547003070,6020204,502955,6020205,41456006,547003075,41456007,547003074,83415301,29706406,547003073,29706407,41456005,547003072,29706404,41456002,547003079,29706405,41456003,547003078,29706402,547003077,29706403,547003076,150102,83415304,545650,83415305,83415302,83415303,547003082,547003081,312025,547003080,547003086,414295,547003085,547003084,547003083,547003089,547003088,547003087,475431,34306,66510203,547003093,547003092,66510209,547003091,66510208,547003090,358310,547003097,547003096,547003095,547003094,253242,547003099,547003098,39515204,475445,139985,39515203,39515202,39515201,232523,514513,25864003,486552,48050902,48050903,48050901,564187,941476,115329,69728103,69728102,409980,47290302,116421,399084,9710501,888880091,888880092,196280,888880095,888880096,281501,109843,431812,749544,45438202,28698201,28698202,321034,888880070,472590,888880079,127001,5175504,5175503,735055001,735055002,65616205,888880083,888880080,65616203,71791306,65616202,71791307,924713,71791304,71791305,888880084,71791302,71791303,888880085,65616201,19018101,75051302,75051303,10051,10052,2380407,2380408,2380405,446042,2380406,67088202,2380409,556886,413125,438423,23493502,578851,331046,33042401,19215402,2380403,2380404,53337502,53337501,2380402,33042408,33042409,33042406,33042407,33042402,33042403,33042411,33042412,33042410,38865202,44512203,556863,10930601,7204102,21163602,4020302,717913,4020301,483669,48604302,439704,888880013,888880011,888880012,55693610,888880018,27079404,25189,473853,530618,55693603,208083,55693602,55693605,55693604,55693607,55693606,55693609,55693608,888880025,888880022,46252402,525043,49236301,49236302,13687403,461611,483643,51564302,470321,412493,888880000,888880001,22864302,22797062,19628003,53728301,888880053,888880054,888880051,53728302,888880058,888880056,538384,36604202,258129,10100601,26768302,53691202,26768303,10100603,10100602,454058,73045002,26768301,888880068,888880066,1762102,45751001,19628004,60889302,42055401,8078,42055402,274830,1751205,1751204,1751201,1751203,549264,1751202,458654,38500502,888880043,887581,888880045,688122,888880048,73505502,73505503,73505504,494723";
    public static void main(String[] args) {
        try {
            String[] arr = DSV1.split(",");
            /*
            Set<String> dsvs1 = new HashSet<>();
            for (int i = 0 ; i < arr.length/2 ; i++){
                dsvs1.add(arr[i]);
            }
            String str1 = String.join(",", dsvs1);

            Set<String> dsvs2 = new HashSet<>();
            for (int i = arr.length/2 ; i < arr.length ; i++){
                dsvs2.add(arr[i]);
            }
            String str2 = String.join(",", dsvs2);
            */
            Set<String> set = Arrays.stream(arr).sorted().collect(Collectors.toSet());
            System.out.println(set.size());
            String dbURL = "jdbc:oracle:thin:@(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ndc-vedip1.walmart.com)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=edip1)))";
            String strUserID = "integration_user";
            String strPassword = "intgrt10n1";
            Connection myConnection= DriverManager.getConnection(dbURL, strUserID, strPassword);

            Map<String, String> map = new HashMap<>();
            Set<String> parents = new HashSet<>();
            Statement sqlStatement = myConnection.createStatement();
            for (String dsv : set) {
                String readRecordSQL = "select * from wfu_message_type_trans where message_type in (select message_type from wfu_message_types where distributor_id in (" + dsv + ") )";
                ResultSet myResultSet = sqlStatement.executeQuery(readRecordSQL);
                while (myResultSet.next()) {
                    //System.out.println("Record values: " + myResultSet.getString("distributor_id"));
                    String child = myResultSet.getString("MESSAGE_TYPE");
                    String parent = myResultSet.getString("MESSAGE_TYPE_TRANS");
                    System.out.println("Child " + child + " parent " + parent);
                    map.put(child, parent);
                }
                myResultSet.close();
            }
            /*
            sqlStatement = myConnection.createStatement();
            readRecordSQL = "select * from wfu_message_type_trans where message_type in (select message_type from wfu_message_types where distributor_id in ("+str2+") and IS_INBOUND='N')";
            myResultSet = sqlStatement.executeQuery(readRecordSQL);
            while (myResultSet.next()) {
                //System.out.println("Record values: " + myResultSet.getString("distributor_id"));
                String child = myResultSet.getString("MESSAGE_TYPE");
                String parent = myResultSet.getString("MESSAGE_TYPE_TRANS");
                System.out.println("Child "+child+" parent "+parent);
                map.put(child, parent);
                parents.add(parent);
            }
            myResultSet.close();
            */


          //  myConnection.close();
            /*
            Map<String, String> filteredDSVs = new HashMap<>();
            //map.entrySet().stream().forEach(entry ->System.out.println(entry.getKey()+" "+entry.getValue()));
            map.entrySet().stream()
               .filter(entry -> dsvs.contains(entry.getKey()))
               .forEach(entry -> filteredDSVs.put(entry.getKey(), entry.getValue()));
             */

            StringBuilder stringBuilder = new StringBuilder();
            stringBuilder.append("<ROWDATA>\n");
            for (Map.Entry<String, String> entry : map.entrySet()) {
                /*
                String readRecordSQL = "select DISTRIBUTOR_ID from wfu_message_types where message_type = "+entry.getKey();
                ResultSet myResultSet = sqlStatement.executeQuery(readRecordSQL);
                String child = null;
                if (myResultSet.next()) {
                    child = myResultSet.getString("DISTRIBUTOR_ID");
                }
                myResultSet.close();

                readRecordSQL = "select DISTRIBUTOR_NAME from wfu_distributor where DISTRIBUTOR_ID = "+child;
                myResultSet = sqlStatement.executeQuery(readRecordSQL);
                String childName = null;
                if (myResultSet.next()) {
                    childName = myResultSet.getString("DISTRIBUTOR_NAME");
                }
                myResultSet.close();
                                */
                String readRecordSQL = "select DISTRIBUTOR_ID from wfu_message_types where message_type = "+entry.getValue();
                ResultSet myResultSet = sqlStatement.executeQuery(readRecordSQL);
                String parent = null;
                if (myResultSet.next()) {
                    parent = myResultSet.getString("DISTRIBUTOR_ID");
                    parents.add(parent);
                }
                myResultSet.close();
                /*
                readRecordSQL = "select DISTRIBUTOR_NAME from wfu_distributor where DISTRIBUTOR_ID = "+parent;
                myResultSet = sqlStatement.executeQuery(readRecordSQL);
                String parentName = null;
                if (myResultSet.next()) {
                    parentName = myResultSet.getString("DISTRIBUTOR_NAME");
                }
                myResultSet.close();

                /*
                stringBuilder.append("<ROW>\n");
                stringBuilder.append("    <CHILD_ID>"+child+"</CHILD_ID>\n");
                stringBuilder.append("    <CHILD_NAME>"+childName+"</CHILD_NAME>\n");
                stringBuilder.append("    <PARENT_ID>"+parent+"</PARENT_ID>\n");
                stringBuilder.append("    <PARENT_NAME>"+parentName+"</PARENT_NAME>\n");
                stringBuilder.append("</ROW>\n");
                */
            }
            String parentString = parents.stream().filter(e -> !set.contains(e)).collect(Collectors.joining(","));
            System.out.println(parentString);

            stringBuilder.append("</ROWDATA>\n");
            System.out.println(stringBuilder.toString());
        } catch (Exception e) {
            System.out.println(e);
        }

    }

}
